<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · PortHamiltonianModelReduction.jl</title><meta name="title" content="API · PortHamiltonianModelReduction.jl"/><meta property="og:title" content="API · PortHamiltonianModelReduction.jl"/><meta property="twitter:title" content="API · PortHamiltonianModelReduction.jl"/><meta name="description" content="Documentation for PortHamiltonianModelReduction.jl."/><meta property="og:description" content="Documentation for PortHamiltonianModelReduction.jl."/><meta property="twitter:description" content="Documentation for PortHamiltonianModelReduction.jl."/><meta property="og:url" content="https://Jonas-Nicodemus.github.io/PortHamiltonianModelReduction.jl/API/"/><meta property="twitter:url" content="https://Jonas-Nicodemus.github.io/PortHamiltonianModelReduction.jl/API/"/><link rel="canonical" href="https://Jonas-Nicodemus.github.io/PortHamiltonianModelReduction.jl/API/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PortHamiltonianModelReduction.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/main/docs/src/API.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><ul><li><a href="#PortHamiltonianModelReduction.TimeDomainData"><code>PortHamiltonianModelReduction.TimeDomainData</code></a></li><li><a href="#PortHamiltonianModelReduction.bt-Tuple{ControlSystemsBase.StateSpace, Any}"><code>PortHamiltonianModelReduction.bt</code></a></li><li><a href="#PortHamiltonianModelReduction.chirp"><code>PortHamiltonianModelReduction.chirp</code></a></li><li><a href="#PortHamiltonianModelReduction.ephminreal-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace}"><code>PortHamiltonianModelReduction.ephminreal</code></a></li><li><a href="#PortHamiltonianModelReduction.estimate_ham-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}"><code>PortHamiltonianModelReduction.estimate_ham</code></a></li><li><a href="#PortHamiltonianModelReduction.hdss-NTuple{7, Any}"><code>PortHamiltonianModelReduction.hdss</code></a></li><li><a href="#PortHamiltonianModelReduction.irka-Tuple{ControlSystemsBase.StateSpace, Any, Any}"><code>PortHamiltonianModelReduction.irka</code></a></li><li><a href="#PortHamiltonianModelReduction.klap"><code>PortHamiltonianModelReduction.klap</code></a></li><li><a href="#PortHamiltonianModelReduction.klap_inital_guess"><code>PortHamiltonianModelReduction.klap_inital_guess</code></a></li><li><a href="#PortHamiltonianModelReduction.matchnrg-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, PortHamiltonianSystems.PortHamiltonianStateSpace}"><code>PortHamiltonianModelReduction.matchnrg</code></a></li><li><a href="#PortHamiltonianModelReduction.matchnrg_are-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.matchnrg_are</code></a></li><li><a href="#PortHamiltonianModelReduction.matchnrg_barrier-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.matchnrg_barrier</code></a></li><li><a href="#PortHamiltonianModelReduction.matchnrg_sdp"><code>PortHamiltonianModelReduction.matchnrg_sdp</code></a></li><li><a href="#PortHamiltonianModelReduction.opinf-Tuple{PortHamiltonianModelReduction.TimeDomainData, Matrix}"><code>PortHamiltonianModelReduction.opinf</code></a></li><li><a href="#PortHamiltonianModelReduction.passivate"><code>PortHamiltonianModelReduction.passivate</code></a></li><li><a href="#PortHamiltonianModelReduction.passivate_lmi-Tuple{ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.passivate_lmi</code></a></li><li><a href="#PortHamiltonianModelReduction.passivate_lmi_tp-Tuple{ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.passivate_lmi_tp</code></a></li><li><a href="#PortHamiltonianModelReduction.pgprojection"><code>PortHamiltonianModelReduction.pgprojection</code></a></li><li><a href="#PortHamiltonianModelReduction.phdmd-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}"><code>PortHamiltonianModelReduction.phdmd</code></a></li><li><a href="#PortHamiltonianModelReduction.phdmd_initial_guess-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractMatrix}"><code>PortHamiltonianModelReduction.phdmd_initial_guess</code></a></li><li><a href="#PortHamiltonianModelReduction.phdmd_sdp-Tuple{PortHamiltonianModelReduction.TimeDomainData}"><code>PortHamiltonianModelReduction.phdmd_sdp</code></a></li><li><a href="#PortHamiltonianModelReduction.phirka-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, Any, Any}"><code>PortHamiltonianModelReduction.phirka</code></a></li><li><a href="#PortHamiltonianModelReduction.pod-Tuple{Any, Any, Any}"><code>PortHamiltonianModelReduction.pod</code></a></li><li><a href="#PortHamiltonianModelReduction.podbasis-Tuple"><code>PortHamiltonianModelReduction.podbasis</code></a></li><li><a href="#PortHamiltonianModelReduction.prbs"><code>PortHamiltonianModelReduction.prbs</code></a></li><li><a href="#PortHamiltonianModelReduction.prbt-Tuple{ControlSystemsBase.StateSpace, Any}"><code>PortHamiltonianModelReduction.prbt</code></a></li><li><a href="#PortHamiltonianModelReduction.sawtooth"><code>PortHamiltonianModelReduction.sawtooth</code></a></li><li><a href="#PortHamiltonianModelReduction.skew_proc-Tuple{AbstractMatrix, AbstractMatrix}"><code>PortHamiltonianModelReduction.skew_proc</code></a></li><li><a href="#PortHamiltonianModelReduction.step"><code>PortHamiltonianModelReduction.step</code></a></li><li><a href="#PortHamiltonianModelReduction.tddata-Tuple"><code>PortHamiltonianModelReduction.tddata</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.TimeDomainData" href="#PortHamiltonianModelReduction.TimeDomainData"><code>PortHamiltonianModelReduction.TimeDomainData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>TimeDomainData{T}</p><p>Data structure to hold time-domain simulation data. See <a href="#PortHamiltonianModelReduction.tddata-Tuple"><code>tddata</code></a> for a convenient constructor.</p><p><strong>Fields</strong></p><ul><li><code>Ẋ</code>: State derivative matrix.</li><li><code>X</code>: State matrix.</li><li><code>U</code>: Input matrix.</li><li><code>Y</code>: Output matrix.</li><li><code>t</code>: Time vector.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/types/TimeDomainData.jl#L5-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.bt-Tuple{ControlSystemsBase.StateSpace, Any}" href="#PortHamiltonianModelReduction.bt-Tuple{ControlSystemsBase.StateSpace, Any}"><code>PortHamiltonianModelReduction.bt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr = bt(Σ::StateSpace, r; Lx=grampd(Σ, :o), Ly=grampd(Σ, :c)&#39;)</code></pre><p>Reduces the state dimension of the system <code>Σ</code> to <code>r</code> using standard square root balanced truncation (see for instance [<a href="../#BS21">1</a>]). The cholesky factors of the Gramians can passed as optional arguments <code>Lx</code> and <code>Ly</code>. The default values are the cholesky factors of the observability and controllability Gramians.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/prbt.jl#L18-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.chirp" href="#PortHamiltonianModelReduction.chirp"><code>PortHamiltonianModelReduction.chirp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chirp(A=1.0, f0=1e-2, f1=1e1, T=2.0)</code></pre><p>Generates a chirp signal with amplitude <code>A</code>, starting frequency <code>f0</code>, ending frequency <code>f1</code>, and duration <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/inputsignals.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.ephminreal-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace}" href="#PortHamiltonianModelReduction.ephminreal-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace}"><code>PortHamiltonianModelReduction.ephminreal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σph = ephminreal(Σph::PortHamiltonianStateSpace; kwargs...)</code></pre><p>Computes a minimal realization of the (extended) pH system (see [<a href="../#HNSU25">2</a>, Cor. 4.6])</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.estimate_ham-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}" href="#PortHamiltonianModelReduction.estimate_ham-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}"><code>PortHamiltonianModelReduction.estimate_ham</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Q, err = estimate_ham(data::TimeDomainData, H::AbstractVector; kwargs...)</code></pre><p>Estimates the Hamiltonian Hessian <code>Q</code> from time-domain <code>data</code> and measurements <code>H</code> of the Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L141-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.hdss-NTuple{7, Any}" href="#PortHamiltonianModelReduction.hdss-NTuple{7, Any}"><code>PortHamiltonianModelReduction.hdss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σqo = hdss(J, R, Q, G, P, S, N)
Σqo = hdss(Σph)</code></pre><p>Converts a <code>PortHamiltonianStateSpace</code> to a <code>QuadraticOutputStateSpace</code> (Hamiltonian dynamic).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.irka-Tuple{ControlSystemsBase.StateSpace, Any, Any}" href="#PortHamiltonianModelReduction.irka-Tuple{ControlSystemsBase.StateSpace, Any, Any}"><code>PortHamiltonianModelReduction.irka</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr = irka(Σ::StateSpace, r; tol=1e-3, max_iter=200)</code></pre><p>Reduces the state dimension of the system <code>Σ</code> to <code>r</code> using the iterative rational Krylov algorithm (IRKA) [<a href="../#GAB08">3</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/irka.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.klap" href="#PortHamiltonianModelReduction.klap"><code>PortHamiltonianModelReduction.klap</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klap(Σ::StateSpace; L0=L0(Σ), M=M(Σ), P=gram(Σ, :c); recycl=:schur, restart=false, α=1e-8, ε=1e-4, verbose=true, kwargs...) -&gt; Σp, res</code></pre><p>Passivates a system <code>Σ</code> using KLAP [<a href="../#NVGU25">4</a>]. The optimization problem is solved using LBFGS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/passivation.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.klap_inital_guess" href="#PortHamiltonianModelReduction.klap_inital_guess"><code>PortHamiltonianModelReduction.klap_inital_guess</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">klap_inital_guess(Σ, ΔD=0.0; ε=1e-8) -&gt; L0, ΔD</code></pre><p>Computes an initial guess for KLAP [<a href="../#NVGU25">4</a>]. The initial guess is computed by perturbing the feedthrough matrix to achieve a passive realization. Then the perturbed system is used to compute the initial guess. The perturbation <code>ΔD</code> can be specified, otherwise it is computed using <code>ΔD(Σ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/passivation.jl#L89-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.matchnrg-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, PortHamiltonianSystems.PortHamiltonianStateSpace}" href="#PortHamiltonianModelReduction.matchnrg-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, PortHamiltonianSystems.PortHamiltonianStateSpace}"><code>PortHamiltonianModelReduction.matchnrg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σrem = matchnrg(Σ::PortHamiltonianStateSpace, Σr::PortHamiltonianStateSpace; solver=:BFGS, kwargs...)</code></pre><p>Applies energy matching [<a href="../#HNSU25">2</a>] to the ROM <code>Σr</code> to match the Hamiltonian dynamics of the original system <code>Σ</code>.  If solver is <code>:Hypatia</code> or <code>:COSMO</code>, it uses semidefinite programming with the specified optimizer.  If solver is <code>:BFGS</code>, it uses the barrier method with BFGS optimization.  If solver is <code>:ARE</code>, the best solution of the ARE is returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L16-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.matchnrg_are-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}" href="#PortHamiltonianModelReduction.matchnrg_are-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.matchnrg_are</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σphr = matchnrg_are(Σ::QuadraticOutputStateSpace, Σr::StateSpace; kwargs...)</code></pre><p>Solves the energy matching problem where the solution set is replaced with solutions of the ARE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L228-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.matchnrg_barrier-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}" href="#PortHamiltonianModelReduction.matchnrg_barrier-Tuple{QuadraticOutputSystems.QuadraticOutputStateSpace, ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.matchnrg_barrier</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σph = matchnrg_barrier(Σ, Σr; Σr0=nothing, kwargs...)</code></pre><p>Solves the energy matching problem using the barrier method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.matchnrg_sdp" href="#PortHamiltonianModelReduction.matchnrg_sdp"><code>PortHamiltonianModelReduction.matchnrg_sdp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σphr = matchnrg_sdp(Σ::QuadraticOutputStateSpace, Σr::StateSpace; optimizer=COSMO.Optimizer, ε=1e-8, kwargs...)</code></pre><p>Solves the energy matching problem using semidefinite programming.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/energymatching.jl#L78-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.opinf-Tuple{PortHamiltonianModelReduction.TimeDomainData, Matrix}" href="#PortHamiltonianModelReduction.opinf-Tuple{PortHamiltonianModelReduction.TimeDomainData, Matrix}"><code>PortHamiltonianModelReduction.opinf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr, res = opinf(data::TimeDomainData, Wr::Matrix)</code></pre><p>Computes a ROM <code>Σr</code> from time-domain data via operator inference (OpInf) [<a href="../#PW16">5</a>].  The error of the OpInf problem is returned as <code>res</code>. The data is projected using with the matrix <code>Wr</code>, which is typically a POD basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.passivate" href="#PortHamiltonianModelReduction.passivate"><code>PortHamiltonianModelReduction.passivate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">passivate(Σ::StateSpace, method=:klap, args...; kwargs...) -&gt; Σp, res</code></pre><p>Passivate the system <code>Σ</code> using the method <code>method</code>. The available methods are:</p><ul><li><code>:klap</code>: KLAP optimization [<a href="../#NVGU25">4</a>]</li><li><code>:lmi</code>: LMI optimization [<a href="../#GS21">6</a>]</li><li><code>:lmi_tp</code>: LMI optimization with trace parametrization [<a href="../#Dum02">7</a>, <a href="../#CPS04">8</a>]</li></ul><p>The remaining arguments <code>args</code> and keyword arguments <code>kwargs</code> are passed to the corresponding passivation function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/passivation.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.passivate_lmi-Tuple{ControlSystemsBase.StateSpace}" href="#PortHamiltonianModelReduction.passivate_lmi-Tuple{ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.passivate_lmi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">passivate_lmi(Σ::StateSpace; kwargs...) -&gt; Σp, model</code></pre><p>Solves the passivation problem for a given state-space system <code>Σ</code> using the positive real LMI constraints [<a href="../#GS21">6</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/passivation.jl#L281-L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.passivate_lmi_tp-Tuple{ControlSystemsBase.StateSpace}" href="#PortHamiltonianModelReduction.passivate_lmi_tp-Tuple{ControlSystemsBase.StateSpace}"><code>PortHamiltonianModelReduction.passivate_lmi_tp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">passivate_lmi_tp(Σ::StateSpace; kwargs...) -&gt; Σp, model</code></pre><p>Solves the passivation problem for a given state-space system <code>Σ</code> using the positive real LMI constraints with trace parametrization [<a href="../#Dum02">7</a>, <a href="../#CPS04">8</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/passivation.jl#L239-L243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.pgprojection" href="#PortHamiltonianModelReduction.pgprojection"><code>PortHamiltonianModelReduction.pgprojection</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pgprojection(Σph::PortHamiltonianStateSpace, V::Matrix, W::Matrix=Σph.Q * V / (V&#39; * Σph.Q * V))
pgprojection(Σ::StateSpace, V::Matrix, W::Matrix=V)</code></pre><p>Applies a (Petrov-)Galerkin projection to a pH or LTI. In the pH case, the <code>W</code> matrix has to be chosen such that the structure is preserved. The default choice is <code>W = Σph.Q * V / (V&#39; * Σph.Q * V)</code>, which is proposed in [<a href="../#GPBS12">9</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/projection.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.phdmd-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}" href="#PortHamiltonianModelReduction.phdmd-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractVector}"><code>PortHamiltonianModelReduction.phdmd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σph, err = phdmd(data::TimeDomainData, H::AbstractVector; kwargs...)
Σph, err = phdmd(data::TimeDomainData, Q::AbstractMatrix; kwargs...)</code></pre><p>Computes a pH system <code>Σph</code> that approximates given time-domain <code>data</code> and a candidate <code>Q</code> for the Hessian of the Hamiltonian or measurements <code>H</code> of the Hamiltonian using the pHDMD method [<a href="../#MNU23">10</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L61-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.phdmd_initial_guess-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractMatrix}" href="#PortHamiltonianModelReduction.phdmd_initial_guess-Tuple{PortHamiltonianModelReduction.TimeDomainData, AbstractMatrix}"><code>PortHamiltonianModelReduction.phdmd_initial_guess</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Γ, W, err = phdmd_initial_guess(data::TimeDomainData, Q::AbstractMatrix; kwargs...)</code></pre><p>Computes an initial guess <code>Γ, W</code> for the pHDMD problem from time-domain data <code>data</code> and a candidate <code>Q</code> for the Hessian of the Hamiltonian (see [<a href="../#MNU23">10</a>, Thm. 3.7]).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L190-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.phdmd_sdp-Tuple{PortHamiltonianModelReduction.TimeDomainData}" href="#PortHamiltonianModelReduction.phdmd_sdp-Tuple{PortHamiltonianModelReduction.TimeDomainData}"><code>PortHamiltonianModelReduction.phdmd_sdp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σph = phdmd_sdp(data::TimeDomainData; kwargs...)
Σph = phdmd_sdp(data::TimeDomainData, Q::AbstractMatrix; kwargs...)</code></pre><p>Computes a pH system <code>Σph</code> that approximates given time-domain <code>data</code> using semidefinite programming. Either the Hessian of the Hamiltonian <code>Q</code> is provided or also learned from the data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L82-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.phirka-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, Any, Any}" href="#PortHamiltonianModelReduction.phirka-Tuple{PortHamiltonianSystems.PortHamiltonianStateSpace, Any, Any}"><code>PortHamiltonianModelReduction.phirka</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr = phirka(Σph::PortHamiltonianStateSpace, r; tol=1e-3, max_iter=50)</code></pre><p>Reduces the state dimension of the port-Hamiltonian system <code>Σph</code> to <code>r</code> using pHIRKA [<a href="../#GPBS12">9</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phirka.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.pod-Tuple{Any, Any, Any}" href="#PortHamiltonianModelReduction.pod-Tuple{Any, Any, Any}"><code>PortHamiltonianModelReduction.pod</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr = pod(Σ, X, r)
Σr = pod(Σ, V, W)</code></pre><p>Returns a ROM <code>Σr</code> of size <code>r</code> for the system <code>Σ</code> using the POD (Petrov-)Galerkin method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L38-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.podbasis-Tuple" href="#PortHamiltonianModelReduction.podbasis-Tuple"><code>PortHamiltonianModelReduction.podbasis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">podbasis(X::AbstractMatrix, r::Int; kwargs...)
podbasis(F::SVD, r::Int; kwargs...)</code></pre><p>Returns the POD basis via the truncated singular value decomposition of a data matrix <code>X</code>. Alternatively, it can be cast on a <code>F::SVD</code> object, such that the SVD is not recomputed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L26-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.prbs" href="#PortHamiltonianModelReduction.prbs"><code>PortHamiltonianModelReduction.prbs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prbs(t, A=1.0, order=7)</code></pre><p>Generates a pseudo-random binary sequence (PRBS) signal with amplitude <code>A</code> and specified <code>order</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/inputsignals.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.prbt-Tuple{ControlSystemsBase.StateSpace, Any}" href="#PortHamiltonianModelReduction.prbt-Tuple{ControlSystemsBase.StateSpace, Any}"><code>PortHamiltonianModelReduction.prbt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Σr = prbt(Σ, r; Lx=prgrampd(Σ, :o), Ly=prgrampd(Σ, :c))</code></pre><p>Reduces the state dimension of the system <code>Σ</code> to <code>r</code> using positive real balanced truncation (PRBT) [<a href="../#DP84">11</a>]. The cholesky factors of the positive real Gramians can passed as optional arguments <code>Lx</code> and <code>Ly</code>, in order to avoid recomputation.  <code>Σ</code> can be a <code>StateSpace</code> or a <code>PortHamiltonianStateSpace</code>, which will then also be the return type. In the case of a <code>PortHamiltonianStateSpace</code>,  for the conversion to the ROM the minimal solution of the KYP inequality is used as the Hessian of the Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/prbt.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.sawtooth" href="#PortHamiltonianModelReduction.sawtooth"><code>PortHamiltonianModelReduction.sawtooth</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sawtooth(A=1.0, T=1.0)</code></pre><p>Generates a sawtooth wave signal with amplitude <code>A</code> and period <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/inputsignals.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.skew_proc-Tuple{AbstractMatrix, AbstractMatrix}" href="#PortHamiltonianModelReduction.skew_proc-Tuple{AbstractMatrix, AbstractMatrix}"><code>PortHamiltonianModelReduction.skew_proc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Γ, err = skew_proc(T::AbstractMatrix, Z::AbstractMatrix; kwargs...)</code></pre><p>Computes the analytic solution of the skew-symmetric Procrustes problem (see for instance [<a href="../#MNU23">10</a>, Thm. 3.4]).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/phdmd.jl#L220-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.step" href="#PortHamiltonianModelReduction.step"><code>PortHamiltonianModelReduction.step</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">step(A=1.0, ts=1.0)</code></pre><p>Generates a step signal with amplitude <code>A</code> and step time <code>ts</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/inputsignals.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PortHamiltonianModelReduction.tddata-Tuple" href="#PortHamiltonianModelReduction.tddata-Tuple"><code>PortHamiltonianModelReduction.tddata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">data = tddata(Ẋ::Matrix{T},X::Matrix{T},U::Matrix{T},Y::Matrix{T},t::Vector{T})
data = tddata(res::SimResult)</code></pre><p>Creates a <code>TimeDomainData</code> object with element type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jonas-Nicodemus/PortHamiltonianModelReduction.jl/blob/dbcc79ebdf1672abf1edefe2309ed3a5d1800cb3/src/types/TimeDomainData.jl#L28-L33">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 28 July 2025 14:45">Monday 28 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
